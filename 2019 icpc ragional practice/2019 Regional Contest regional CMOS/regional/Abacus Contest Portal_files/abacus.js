(function(i){window.jAlert=function(s,r,t){if(r==null){r="Alert"}if(t==null){t=function(u){return false}}i("#alert-dialog-text").text(s);i("#alert-dialog").dialog({title:r,buttons:{Ok:function(u){i(this).dialog("close");t(u)}}}).dialog("open")};this.RunResult={PENDING:-1,CORRECT:0,WRONG:1,TIME_EXCEEDED:2,ABNORMAL:3,COMPILE_FAILED:4,JUDGE:5,FORMAT_ERROR:6,OTHER:7};var b=["Pending","Correct answer","Wrong answer","Time limit exceeded","Abnormal termination of program","Compilation failed","Deferred to judge","Format error","Other - contact a judge"];this.runResultString=function(r){return b[r+1]};var d=function(r,s,t){return padNumber(r)+":"+padNumber(s)+":"+padNumber(t)};this.dateToString=function(s){var u=s.getSeconds();var t=s.getMinutes();var r=s.getHours();return d(r,t,u)};this.epochTimeToString=function(s){var r=new Date();r.setTime(s*1000);return dateToString(r)};this.timeToString=function(t){if(t<0){return"-"+timeToString(-t)}var u=t%60;var s=(t-u)/60%60;var r=(t-60*s-u)/3600;return padNumber(r)+":"+padNumber(s)+":"+padNumber(u)};this.parseUtf8=function(s){if(typeof s==="undefined"){return""}var z=new Array;for(var y,x,w=-1,u=s.length,t=String.fromCharCode;++w<u;){var v=s[w];y=v;if(y&128){if((y&252)==192){x=s[w+1];if((x&192)==128){var r=t(((y&3)<<6)+(x&63));z.push(r)}else{var r=t(128);z.push(r)}}else{var r=t(128);z.push(r)}++w}else{var r=t(v);z.push(r)}}return z.join("")};this.escapeHTML=function(r){return r.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;")};this.padNumber=function(r){var t=""+r;while(t.length<2){t="0"+t}return t};var k=i.cometd;var n=new Array();this.nullReplyHandler=function(r){};this.defaultReplyHandler=function(r){if(r.data.name=="err"){window.jAlert(r.data.headers.msg)}};var a=nullReplyHandler;var q=false;this.queueHandler=function(s,r){var t={};t.handler=r;t.handlerOnly=true;t.data=s;queueAndProcessMessage(t)};this.sendMessageBlock=function(t,r){var s={};s.msg=t;s.handler=r;s.handlerOnly=false;queueAndProcessMessage(s)};this.queueAndProcessMessage=function(r){n.push(r);j()};this.resetMessageQueue=function(){n=new Array();a=nullReplyHandler;q=false;o()};var j=function(){if(q){return}if(n.length>0){var r=n.shift();p(n.length+1);q=true;a=r.handler;if(r.handlerOnly){f({data:{name:"ok",data:r.data}})}else{logSentMessage(r.msg);k.publish("/service/abacus",r.msg)}}else{o();q=false}};var f=function(s){try{switch(s.data.name){case"ok":case"err":if(q){try{a(s)}catch(r){logException('Unexpected exception "'+r+'" generated whilst processing message "'+s.data.name+'"')}q=false;j()}break;case"updateclarificationrequests":updateClarificationRequests(s);showNotification("clarification-requests","New clarification request",s.data.headers.question);break;case"updateclarifications":updateClarifications(s);showNotification("clarifications","New clarification",s.data.headers.answer);break;case"updatesubmissions":if(updateSubmissions(s)){showNotification("submissions","Updated submission","#"+s.data.headers.submission_id+": "+s.data.headers.comment)}break;case"updatestandings":updateStandings(s);break;case"startstop":startStop(s);break;case"connectionreset":connectionReset();break;default:break}}catch(r){window.jAlert('Unexpected exception "'+r+'" generated whilst processing message "'+s.data.name+'"')}};var m=function(r){if(r.successful===true){connectionReset()}};var p=function(r){var s="<span>Working; "+r+" message"+(r>1?"s":"")+" remaining... please wait</span>";i("#waiting").html(s);i("#waiting").show()};var o=function(){i("#waiting").hide()};var c=function(r){i("#status").html("<p>"+r+"</p>")};var h=false;var l=function(r){if(h!=r){h=r;if(h){i("#status-connected").show();i("#status-disconnected").hide()}else{i("#status-connected").hide();i("#status-disconnected").show()}}};var e=function(r){if(k.isDisconnected()){l(false)}else{l(r.successful===true)}};var g=function(r){l(false)};this.showNotification=function(t,u,r){var s=i("#"+t+"-tab-label");if(!s.parent().parent().hasClass("ui-tabs-active")){s.addClass("tab-highlight")}if(u!==null&&"Notification" in window){if(Notification.permission==="granted"){var v=new Notification(u,{body:r,tag:t});setTimeout(v.close.bind(v),5000)}}};this.hideTab=function(r){i("#tabs").tabs("disable","#"+r)};this.showTab=function(r){i("#tabs").tabs("enable","#"+r)};i(document).ready(function(){i("#alert-dialog").dialog({disabled:false,autoOpen:false,closeOnEscape:true,draggable:true,modal:true,position:"center",title:"Alert",width:"auto",height:"auto"});i("#login-dialog").dialog({disabled:false,autoOpen:false,closeOnEscape:false,draggable:true,modal:true,position:"center",resizable:false,title:"Login to Abacus",width:"auto",height:"auto",beforeClose:isLoginCloseAllowed,open:function(s,t){i(this).closest(".ui-dialog").find(".ui-dialog-titlebar-close").hide()}});i("#clarification-request-dialog").dialog({disabled:false,autoOpen:false,closeOnEscape:true,draggable:true,modal:true,position:"center",resizable:false,title:"Request clarification",width:"auto",height:"auto"});i("#submission-dialog").dialog({disabled:false,autoOpen:false,closeOnEscape:true,draggable:true,modal:true,position:"center",resizable:false,close:submissionDialogClose,title:"Make submission",width:"auto",height:"auto"});i("#submission-result-dialog").dialog({disabled:false,autoOpen:false,closeOnEscape:true,draggable:true,modal:true,position:"center",resizable:false,title:"Submission result",width:"auto",height:"auto"});i("#waiting").hide();i("#tabs").hide();i("#logout").hide();i("#status-connected").hide();showLoginDialog();i(window).unload(function(){k.disconnect(true)});i("#tabs").tabs({activate:function(s,t){i(t.newTab).find(".tab-highlight").removeClass("tab-highlight");return true}});hideTab("tab-resources");hideDebug();if("Notification" in window){Notification.requestPermission()}k.unregisterTransport("websocket");var r=location.protocol+"//"+location.host+config.contextPath+"/cometd";k.configure({url:r,logLevel:"debug"});k.addListener("/meta/handshake",m);k.addListener("/meta/connect",e);k.addListener("/meta/disconnect",g);k.addListener("/service/abacus",f);k.addListener("/service/abacus",logReceivedHandler);k.addListener("/service/log",logChannelHandler);k.handshake()})})(jQuery);(function(f){var l=new Array();var k=new Array();var j=-1;var g=-1;var c=function(w){var u=new Array();for(var v=0;v<w.length;v++){if(w[v]=="\n"){u.push(String.fromCharCode(1))}else{u.push(w[v])}}return u.join("")};var a=function(z,w){var u=new Array();var y=w?"\n":"<br />";var v=String.fromCharCode(1);for(var x=0;x<z.length;x++){if(z[x]==v){u.push(y)}else{u.push(z[x])}}return u.join("")};var s=function(y){var u=new Array();var v=40;var w=String.fromCharCode(1);var z=false;for(var x=0;x<y.length;x++){if(y[x]==w||x==v){z=true;break}u.push(y[x])}if(z){u.push(" ...")}return u.join("")};this.updateClarificationRequests=function(v){var u={};u.id=v.data.headers.id;u.time=v.data.headers.time;u.user_id=v.data.headers.user_id;u.problem=v.data.headers.problem;u.question=v.data.headers.question;l.push(u);m()};this.getClarificationRequests=function(){sendMessageBlock({name:"getclarificationrequests",headers:{}},r)};function m(){l.sort(function(C,B){var D=B.time-C.time;if(D==0){D=B.id-C.id}return D});var y="";for(var x=0;x<l.length;x++){var z=l[x];var A=false;for(var w=0;w<k.length;w++){var v=k[w];if(v.req_id==z.id){A=true;break}}var u=A?'<span class="clarification-request-answered">Answered</span>':'<span class="clarification-request-unanswered">Unanswered</span>';y+='<tr class="clarification-request-row"><td>'+z.id+"</td><td>"+escapeHTML(epochTimeToString(z.time))+"</td><td>"+escapeHTML(z.problem)+"</td><td>"+u+"</td><td>"+a(escapeHTML(s(z.question)),false)+"</td></tr>"}f("#clarification-requests-tbody").html(y);f("tr.clarification-request-row").click(function(){var B=f(f(this).children()[0]).text();p(B,-1,0)});f("tr.clarification-request-row").hover(function(){f(this).addClass("row-hover");f(this).addClass("pointer-hover")},function(){f(this).removeClass("row-hover");f(this).removeClass("pointer-hover")})}function r(w){if(w.data.name!="ok"){window.jAlert("Error updating clarification requests: "+w.data.headers.msg);return}var x=new Array();var u=0;do{var v={};v.time=w.data.headers["time"+u];if(typeof v.time==="undefined"){break}v.id=w.data.headers["id"+u];v.question=w.data.headers["question"+u];v.problem=w.data.headers["problem"+u];v.user_id=w.data.headers["user_id"+u];x.push(v);u++}while(true);l=x;m()}var q=function(w){for(var u=0;u<l.length;u++){var v=l[u];if(v.id==w){return v}}return false};var d=function(w){for(var v=0;v<k.length;v++){var u=k[v];if(u.id==w){return u}}return false};var p=function(v,A,x){if(v<0){v=d(A).req_id}g=v;var z=false;var C=new Array();var D=0;for(var y=0;y<k.length;y++){var u=k[y];if(u.req_id==v){z=true;if(A==u.id){D=C.length}C.push(u)}}D+=x;if(!z){f("#clarification-request-details-dialog-answer-row").hide();f("#clarification-request-details-dialog-previous").hide();f("#clarification-request-details-dialog-next").hide();var w=q(v);f("#clarification-request-details-dialog-question").val(a(w.question,true))}else{f("#clarification-request-details-dialog-answer-row").show();f("#clarification-request-details-dialog-next").toggle(D>0);f("#clarification-request-details-dialog-previous").toggle(D<C.length-1);f("#clarification-request-details-dialog-question").val(a(C[D].question,true));f("#clarification-request-details-dialog-answer").val(a(C[D].answer,true));j=C[D].id}var B=hasPermission("clarification_reply");f("#clarification-request-details-dialog-reply").toggle(B);f("#clarification-request-details-dialog").dialog("open")};var t=function(v){var u=q(v);f("#clarification-reply-dialog-question").val(a(u.question,true));f("#clarification-reply-dialog-reply").val("");f("#clarification-reply-dialog-visibility").val(0);f("#clarification-reply-dialog").dialog("open")};this.updateClarifications=function(v){var u={};u.id=v.data.headers.id;u.req_id=v.data.headers.req_id;u.time=v.data.headers.time;u.problem=v.data.headers.problem;u.question=v.data.headers.question;u.answer=v.data.headers.answer;k.push(u);o();m()};this.getClarifications=function(){sendMessageBlock({name:"getclarifications",headers:{}},b)};function o(){k.sort(function(y,x){var z=x.time-y.time;if(z==0){z=x.id-y.id}return z});var w="";for(var v=0;v<k.length;v++){var u=k[v];w+='<tr class="clarification-row"><td>'+u.id+"</td><td>"+u.req_id+"</td><td>"+escapeHTML(epochTimeToString(u.time))+"</td><td>"+escapeHTML(u.problem)+"</td><td>"+a(escapeHTML(s(u.question)),false)+"</td><td>"+a(escapeHTML(s(u.answer)),false)+"</td></tr>"}f("#clarifications-tbody").html(w);f("tr.clarification-row").click(function(){var x=f(f(this).children()[0]).text();p(-1,x,0)});f("tr.clarification-row").hover(function(){f(this).addClass("row-hover");f(this).addClass("pointer-hover")},function(){f(this).removeClass("row-hover");f(this).removeClass("pointer-hover")})}function b(x){if(x.data.name!="ok"){window.jAlert("Error updating clarifications: "+x.data.headers.msg);return}var v=new Array();var w=0;do{var u={};u.time=x.data.headers["time"+w];if(typeof u.time==="undefined"){break}u.req_id=x.data.headers["req_id"+w];u.id=x.data.headers["id"+w];u.question=x.data.headers["question"+w];u.problem=x.data.headers["problem"+w];u.answer=x.data.headers["answer"+w];v.push(u);w++}while(true);k=v;o()}this.requestClarificationDialog=function(v,u){getProblems();queueHandler({problemId:v,question:u},e)};function e(u){if(u.data.data.problemId!=""){f("#clarification-request-dialog-problems").val(u.data.data.problemId)}f("#clarification-request-dialog-question").val(u.data.data.question);f("#clarification-request-dialog").dialog("open")}function i(u){if(u.data.name=="ok"){f("#clarification-request-dialog").dialog("close")}else{window.jAlert("Failed to send clarification request. Error was: "+u.data.headers.msg)}}var n=function(v,x){var w=f("#clarification-reply-dialog-reply").val();var u=f("#clarification-reply-dialog-visibility").val();sendMessageBlock({name:"clarification",headers:{clarification_request_id:g,answer:c(w),"public":u}},h)};var h=function(u){if(u.data.name=="ok"){f("#clarification-reply-dialog").dialog("close")}else{defaultReplyHandler(u)}};f(document).ready(function(){f("#clarification-reply-dialog").dialog({disabled:false,autoOpen:false,closeOnEscape:true,draggable:true,modal:true,position:"center",resizable:false,title:"Make clarification",width:"auto",height:"auto",buttons:{Ok:n,Cancel:function(u){f(this).dialog("close")}}});f("#clarification-request-details-dialog").dialog({disabled:false,autoOpen:false,closeOnEscape:true,draggable:true,modal:true,position:"center",resizable:false,title:"Details of clarification request",width:"auto",height:"auto"});f("#clarification-request-details-dialog-ok").click(function(u){f("#clarification-request-details-dialog").dialog("close")});f("#clarification-request-details-dialog-previous").click(function(u){p(-1,j,1)});f("#clarification-request-details-dialog-next").click(function(u){p(-1,j,-1)});f("#clarification-request-details-dialog-reply").click(function(u){f("#clarification-request-details-dialog").dialog("close");t(g)});f("#clarification-requests-request").click(function(u){requestClarificationDialog("","")});f("#clarification-request-dialog-submit").click(function(w){var x=f("#clarification-request-dialog-problems").val();if(x==-1){window.jAlert("You must select a problem!");return}var u=f("#clarification-request-dialog-question").val();var v=/^(?:\[Submission \d+\])?\s*$/;if(v.test(u)){window.jAlert("Please write a question!");return}sendMessageBlock({name:"clarificationrequest",headers:{prob_id:x,question:c(u)}},i)});f("#clarification-request-dialog-cancel").click(function(u){f("#clarification-request-dialog").dialog("close")})})})(jQuery);(function(f){var d;var c;var e;this.registerStartStop=function(){sendMessageBlock({name:"subscribetime",headers:{}},nullReplyHandler)};this.getContestStatus=function(){sendMessageBlock({name:"contesttime",headers:{}},b)};function b(j){if(j.data.name!="ok"){window.jAlert("Error updating status: "+j.data.headers.msg);return}var g;e=parseInt(j.data.headers.remain,10);c=parseInt(j.data.headers.blinds,10);if(j.data.headers.running=="yes"){var k=new Date().getTime();var i=f.cometd.getExtension("timesync").getNetworkLag();k-=i;logLine("Lag from server is currently "+i+"ms");var h=Math.floor(k/1000);d=h+e}else{d=0}a()}this.startStop=function(g){if(g.data.headers.action=="start"){window.jAlert("The contest has been started")}else{d=0;window.jAlert("The contest has been stopped")}a();getContestStatus()};function a(){var g;var i;if(d==0){g="Contest stopped";i=e}else{var h=Math.floor(new Date().getTime()/1000);i=d-h;if(i<0){i=0}g="Contest running: "+timeToString(i)+" remaining";setTimeout(a,1000)}if(hasPermission("see_final_standings")||i>=c){f("#standings-frozen").removeClass("frozen")}else{f("#standings-frozen").addClass("frozen")}f("#contest-status").html(g)}f(document).ready(function(){f("#contest-status").hide()})})(jQuery);(function(b){this.showDebug=function(){showTab("tab-debug");showTab("tab-log")};this.hideDebug=function(){hideTab("tab-debug");hideTab("tab-log")};var a=function(d){var f=b("#log");var g=new Date()+": ";var h=g+"----------------------------\n";for(var e=0;e<d.length;e++){h+=g+d[e]+"\n"}f.html(f.html()+escapeHTML(h))};this.logLine=function(d){a([d])};var c=function(e,g){var d=new Array();d.push(e);d.push(g.name);for(var f in g.headers){d.push("\t"+f+":"+g.headers[f])}if(b.isArray(g.content)){d.push("content-length:"+g.content.length)}a(d)};this.logReceivedHandler=function(d){c("Received",d.data)};this.logSentMessage=function(d){c("Sent",d)};this.logException=function(d){logLine(d);window.jAlert(d,"Unexpected exception")};this.logChannelHandler=function(d){logLine(d.data)};this.debugHook=function(d){if(d=="debug show"){showDebug()}else{if(d=="debug hide"){hideDebug()}}};b(document).ready(function(){b("#out-msg-submit").click(function(f){var h,e;h={};h.name=b("#out-msg-name")[0].value;h.headers={};e=1;while(e<20){var d=b("#out-msg-key"+e);if(d.length==0){break}var g=b("#out-msg-value"+e);if(g.length==0){break}d=d[0].value;g=g[0].value;if(d.length>0&&g.length>0){h.headers[d]=g}e++}sendMessageBlock(h,defaultReplyHandler)})})})(jQuery);var qq=qq||{};qq.extend=function(b,a){for(var c in a){b[c]=a[c]}};qq.indexOf=function(b,c,d){if(b.indexOf){return b.indexOf(c,d)}d=d||0;var a=b.length;if(d<0){d+=a}for(;d<a;d++){if(d in b&&b[d]===c){return d}}return -1};qq.getUniqueId=(function(){var a=0;return function(){return a++}})();qq.attach=function(a,c,b){if(a.addEventListener){a.addEventListener(c,b,false)}else{if(a.attachEvent){a.attachEvent("on"+c,b)}}};qq.detach=function(a,c,b){if(a.removeEventListener){a.removeEventListener(c,b,false)}else{if(a.attachEvent){a.detachEvent("on"+c,b)}}};qq.preventDefault=function(a){if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}};qq.insertBefore=function(d,c){c.parentNode.insertBefore(d,c)};qq.remove=function(a){a.parentNode.removeChild(a)};qq.contains=function(b,a){if(b==a){return true}if(b.contains){return b.contains(a)}else{return !!(a.compareDocumentPosition(b)&8)}};qq.toElement=(function(){var a=document.createElement("div");return function(c){a.innerHTML=c;var b=a.firstChild;a.removeChild(b);return b}})();qq.css=function(a,b){if(b.opacity!=null){if(typeof a.style.opacity!="string"&&typeof(a.filters)!="undefined"){b.filter="alpha(opacity="+Math.round(100*b.opacity)+")"}}qq.extend(a.style,b)};qq.hasClass=function(b,a){var c=new RegExp("(^| )"+a+"( |$)");return c.test(b.className)};qq.addClass=function(b,a){if(!qq.hasClass(b,a)){b.className+=" "+a}};qq.removeClass=function(b,a){var c=new RegExp("(^| )"+a+"( |$)");b.className=b.className.replace(c," ").replace(/^\s+|\s+$/g,"")};qq.setText=function(a,b){a.innerText=b;a.textContent=b};qq.children=function(b){var a=[],c=b.firstChild;while(c){if(c.nodeType==1){a.push(c)}c=c.nextSibling}return a};qq.getByClass=function(d,e){if(d.querySelectorAll){return d.querySelectorAll("."+e)}var b=[];var f=d.getElementsByTagName("*");var a=f.length;for(var c=0;c<a;c++){if(qq.hasClass(f[c],e)){b.push(f[c])}}return b};qq.obj2url=function(f,b,h){var g=[],d="&",e=function(k,j){var l=b?(/\[\]$/.test(b))?b:b+"["+j+"]":j;if((l!="undefined")&&(j!="undefined")){g.push((typeof k==="object")?qq.obj2url(k,l,true):(Object.prototype.toString.call(k)==="[object Function]")?encodeURIComponent(l)+"="+encodeURIComponent(k()):encodeURIComponent(l)+"="+encodeURIComponent(k))}};if(!h&&b){d=(/\?/.test(b))?(/\?$/.test(b))?"":"&":"?";g.push(b);g.push(qq.obj2url(f))}else{if((Object.prototype.toString.call(f)==="[object Array]")&&(typeof f!="undefined")){for(var c=0,a=f.length;c<a;++c){e(f[c],c)}}else{if((typeof f!="undefined")&&(f!==null)&&(typeof f==="object")){for(var c in f){e(f[c],c)}}else{g.push(encodeURIComponent(b)+"="+encodeURIComponent(f))}}}return g.join(d).replace(/^&/,"").replace(/%20/g,"+")};var qq=qq||{};qq.FileUploaderBasic=function(a){this._options={debug:false,action:"/server/upload",params:{},button:null,multiple:true,maxConnections:3,allowedExtensions:[],sizeLimit:0,minSizeLimit:0,onSubmit:function(c,b){},onProgress:function(e,d,b,c){},onComplete:function(d,c,b){},onCancel:function(c,b){},messages:{typeError:"{file} has invalid extension. Only {extensions} are allowed.",sizeError:"{file} is too large, maximum file size is {sizeLimit}.",minSizeError:"{file} is too small, minimum file size is {minSizeLimit}.",emptyError:"{file} is empty, please select files again without it.",onLeave:"The files are being uploaded, if you leave now the upload will be cancelled."},showMessage:function(b){jAlert(b)}};qq.extend(this._options,a);this._filesInProgress=0;this._handler=this._createUploadHandler();if(this._options.button){this._button=this._createUploadButton(this._options.button)}this._preventLeaveInProgress()};qq.FileUploaderBasic.prototype={setParams:function(a){this._options.params=a},getInProgress:function(){return this._filesInProgress},_createUploadButton:function(b){var a=this;return new qq.UploadButton({element:b,multiple:this._options.multiple&&qq.UploadHandlerXhr.isSupported(),onChange:function(c){a._onInputChange(c)}})},_createUploadHandler:function(){var a=this,c;if(qq.UploadHandlerXhr.isSupported()){c="UploadHandlerXhr"}else{c="UploadHandlerForm"}var b=new qq[c]({debug:this._options.debug,action:this._options.action,maxConnections:this._options.maxConnections,onProgress:function(g,f,d,e){a._onProgress(g,f,d,e);a._options.onProgress(g,f,d,e)},onComplete:function(f,e,d){a._onComplete(f,e,d);a._options.onComplete(f,e,d)},onCancel:function(e,d){a._onCancel(e,d);a._options.onCancel(e,d)}});return b},_preventLeaveInProgress:function(){var a=this;qq.attach(window,"beforeunload",function(b){if(!a._filesInProgress){return}var b=b||window.event;b.returnValue=a._options.messages.onLeave;return a._options.messages.onLeave})},_onSubmit:function(b,a){this._filesInProgress++},_onProgress:function(d,c,a,b){},_onComplete:function(c,b,a){this._filesInProgress--;if(a.error){this._options.showMessage(a.error)}},_onCancel:function(b,a){this._filesInProgress--},_onInputChange:function(a){if(this._handler instanceof qq.UploadHandlerXhr){this._uploadFileList(a.files)}else{if(this._validateFile(a)){this._uploadFile(a)}}this._button.reset()},_uploadFileList:function(b){for(var a=0;a<b.length;a++){if(!this._validateFile(b[a])){return}}for(var a=0;a<b.length;a++){this._uploadFile(b[a])}},_uploadFile:function(a){var c=this._handler.add(a);var b=this._handler.getName(c);if(this._options.onSubmit(c,b)!==false){this._onSubmit(c,b);this._handler.upload(c,this._options.params)}},_validateFile:function(c){var a,b;if(c.value){a=c.value.replace(/.*(\/|\\)/,"")}else{a=c.fileName!=null?c.fileName:c.name;b=c.fileSize!=null?c.fileSize:c.size}if(!this._isAllowedExtension(a)){this._error("typeError",a);return false}else{if(b===0){this._error("emptyError",a);return false}else{if(b&&this._options.sizeLimit&&b>this._options.sizeLimit){this._error("sizeError",a);return false}else{if(b&&b<this._options.minSizeLimit){this._error("minSizeError",a);return false}}}}return true},_error:function(c,d){var b=this._options.messages[c];function a(e,f){b=b.replace(e,f)}a("{file}",this._formatFileName(d));a("{extensions}",this._options.allowedExtensions.join(", "));a("{sizeLimit}",this._formatSize(this._options.sizeLimit));a("{minSizeLimit}",this._formatSize(this._options.minSizeLimit));this._options.showMessage(b)},_formatFileName:function(a){if(a.length>33){a=a.slice(0,19)+"..."+a.slice(-13)}return a},_isAllowedExtension:function(d){var b=(-1!==d.indexOf("."))?d.replace(/.*[.]/,"").toLowerCase():"";var c=this._options.allowedExtensions;if(!c.length){return true}for(var a=0;a<c.length;a++){if(c[a].toLowerCase()==b){return true}}return false},_formatSize:function(a){var b=-1;do{a=a/1024;b++}while(a>99);return Math.max(a,0.1).toFixed(1)+["kB","MB","GB","TB","PB","EB"][b]}};qq.FileUploader=function(a){qq.FileUploaderBasic.apply(this,arguments);qq.extend(this._options,{element:null,listElement:null,template:'<div class="qq-uploader"><div class="qq-upload-drop-area"><span>Drop files here to upload</span></div><div class="qq-upload-button">Upload a file</div><ul class="qq-upload-list"></ul></div>',fileTemplate:'<li><span class="qq-upload-file"></span><span class="qq-upload-spinner"></span><span class="qq-upload-size"></span><a class="qq-upload-cancel" href="#">Cancel</a><span class="qq-upload-failed-text">Failed</span></li>',classes:{button:"qq-upload-button",drop:"qq-upload-drop-area",dropActive:"qq-upload-drop-area-active",list:"qq-upload-list",file:"qq-upload-file",spinner:"qq-upload-spinner",size:"qq-upload-size",cancel:"qq-upload-cancel",success:"qq-upload-success",fail:"qq-upload-fail"}});qq.extend(this._options,a);this._element=this._options.element;this._element.innerHTML=this._options.template;this._listElement=this._options.listElement||this._find(this._element,"list");this._classes=this._options.classes;this._button=this._createUploadButton(this._find(this._element,"button"));this._bindCancelEvent();this._setupDragDrop()};qq.extend(qq.FileUploader.prototype,qq.FileUploaderBasic.prototype);qq.extend(qq.FileUploader.prototype,{_find:function(c,b){var a=qq.getByClass(c,this._options.classes[b])[0];if(!a){throw new Error("element not found "+b)}return a},_setupDragDrop:function(){var b=this,c=this._find(this._element,"drop");var a=new qq.UploadDropZone({element:c,onEnter:function(d){qq.addClass(c,b._classes.dropActive);d.stopPropagation()},onLeave:function(d){d.stopPropagation()},onLeaveNotDescendants:function(d){qq.removeClass(c,b._classes.dropActive)},onDrop:function(d){c.style.display="none";qq.removeClass(c,b._classes.dropActive);b._uploadFileList(d.dataTransfer.files)}});c.style.display="none";qq.attach(document,"dragenter",function(d){if(!a._isValidFileDrag(d)){return}c.style.display="block"});qq.attach(document,"dragleave",function(f){if(!a._isValidFileDrag(f)){return}var d=document.elementFromPoint(f.clientX,f.clientY);if(!d||d.nodeName=="HTML"){c.style.display="none"}})},_onSubmit:function(b,a){qq.FileUploaderBasic.prototype._onSubmit.apply(this,arguments);this._addToList(b,a)},_onProgress:function(g,f,a,d){qq.FileUploaderBasic.prototype._onProgress.apply(this,arguments);var c=this._getItemByFileId(g);var b=this._find(c,"size");b.style.display="inline";var e;if(a!=d){e=Math.round(a/d*100)+"% from "+this._formatSize(d)}else{e=this._formatSize(d)}qq.setText(b,e)},_onComplete:function(d,c,a){qq.FileUploaderBasic.prototype._onComplete.apply(this,arguments);var b=this._getItemByFileId(d);qq.remove(this._find(b,"cancel"));qq.remove(this._find(b,"spinner"));if(a.success){qq.addClass(b,this._classes.success)}else{qq.addClass(b,this._classes.fail)}},_addToList:function(d,c){var a=qq.toElement(this._options.fileTemplate);a.qqFileId=d;var b=this._find(a,"file");qq.setText(b,this._formatFileName(c));this._find(a,"size").style.display="none";this._listElement.appendChild(a)},_getItemByFileId:function(b){var a=this._listElement.firstChild;while(a){if(a.qqFileId==b){return a}a=a.nextSibling}},_bindCancelEvent:function(){var a=this,b=this._listElement;qq.attach(b,"click",function(f){f=f||window.event;var d=f.target||f.srcElement;if(qq.hasClass(d,a._classes.cancel)){qq.preventDefault(f);var c=d.parentNode;a._handler.cancel(c.qqFileId);qq.remove(c)}})}});qq.UploadDropZone=function(a){this._options={element:null,onEnter:function(b){},onLeave:function(b){},onLeaveNotDescendants:function(b){},onDrop:function(b){}};qq.extend(this._options,a);this._element=this._options.element;this._disableDropOutside();this._attachEvents()};qq.UploadDropZone.prototype={_disableDropOutside:function(a){if(!qq.UploadDropZone.dropOutsideDisabled){qq.attach(document,"dragover",function(b){if(b.dataTransfer){b.dataTransfer.dropEffect="none";b.preventDefault()}});qq.UploadDropZone.dropOutsideDisabled=true}},_attachEvents:function(){var a=this;qq.attach(a._element,"dragover",function(c){if(!a._isValidFileDrag(c)){return}var b=c.dataTransfer.effectAllowed;if(b=="move"||b=="linkMove"){c.dataTransfer.dropEffect="move"}else{c.dataTransfer.dropEffect="copy"}c.stopPropagation();c.preventDefault()});qq.attach(a._element,"dragenter",function(b){if(!a._isValidFileDrag(b)){return}a._options.onEnter(b)});qq.attach(a._element,"dragleave",function(c){if(!a._isValidFileDrag(c)){return}a._options.onLeave(c);var b=document.elementFromPoint(c.clientX,c.clientY);if(qq.contains(this,b)){return}a._options.onLeaveNotDescendants(c)});qq.attach(a._element,"drop",function(b){if(!a._isValidFileDrag(b)){return}b.preventDefault();a._options.onDrop(b)})},_isValidFileDrag:function(c){var b=c.dataTransfer,a=navigator.userAgent.indexOf("AppleWebKit")>-1;return b&&b.effectAllowed!="none"&&(b.files||(!a&&b.types.contains&&b.types.contains("Files")))}};qq.UploadButton=function(a){this._options={element:null,multiple:false,name:"file",onChange:function(b){},hoverClass:"qq-upload-button-hover",focusClass:"qq-upload-button-focus"};qq.extend(this._options,a);this._element=this._options.element;qq.css(this._element,{position:"relative",overflow:"hidden",direction:"ltr"});this._input=this._createInput()};qq.UploadButton.prototype={getInput:function(){return this._input},reset:function(){if(this._input.parentNode){qq.remove(this._input)}qq.removeClass(this._element,this._options.focusClass);this._input=this._createInput()},_createInput:function(){var b=document.createElement("input");if(this._options.multiple){b.setAttribute("multiple","multiple")}b.setAttribute("type","file");b.setAttribute("name",this._options.name);qq.css(b,{position:"absolute",right:0,top:0,fontFamily:"Arial",fontSize:"118px",margin:0,padding:0,cursor:"pointer",opacity:0});this._element.appendChild(b);var a=this;qq.attach(b,"change",function(){a._options.onChange(b)});qq.attach(b,"mouseover",function(){qq.addClass(a._element,a._options.hoverClass)});qq.attach(b,"mouseout",function(){qq.removeClass(a._element,a._options.hoverClass)});qq.attach(b,"focus",function(){qq.addClass(a._element,a._options.focusClass)});qq.attach(b,"blur",function(){qq.removeClass(a._element,a._options.focusClass)});if(window.attachEvent){b.setAttribute("tabIndex","-1")}return b}};qq.UploadHandlerAbstract=function(a){this._options={debug:false,action:"/upload.php",maxConnections:999,onProgress:function(e,d,b,c){},onComplete:function(d,c,b){},onCancel:function(c,b){}};qq.extend(this._options,a);this._queue=[];this._params=[]};qq.UploadHandlerAbstract.prototype={log:function(a){if(this._options.debug&&window.console){console.log("[uploader] "+a)}},add:function(a){},upload:function(d,b){var a=this._queue.push(d);var c={};qq.extend(c,b);this._params[d]=c;if(a<=this._options.maxConnections){this._upload(d,this._params[d])}},cancel:function(a){this._cancel(a);this._dequeue(a)},cancelAll:function(){for(var a=0;a<this._queue.length;a++){this._cancel(this._queue[a])}this._queue=[]},getName:function(a){},getSize:function(a){},getQueue:function(){return this._queue},_upload:function(a){},_cancel:function(a){},_dequeue:function(d){var b=qq.indexOf(this._queue,d);this._queue.splice(b,1);var a=this._options.maxConnections;if(this._queue.length>=a){var c=this._queue[a-1];this._upload(c,this._params[c])}}};qq.UploadHandlerForm=function(a){qq.UploadHandlerAbstract.apply(this,arguments);this._inputs={}};qq.extend(qq.UploadHandlerForm.prototype,qq.UploadHandlerAbstract.prototype);qq.extend(qq.UploadHandlerForm.prototype,{add:function(a){a.setAttribute("name","qqfile");var b="qq-upload-handler-iframe"+qq.getUniqueId();this._inputs[b]=a;if(a.parentNode){qq.remove(a)}return b},getName:function(a){return this._inputs[a].value.replace(/.*(\/|\\)/,"")},_cancel:function(b){this._options.onCancel(b,this.getName(b));delete this._inputs[b];var a=document.getElementById(b);if(a){a.setAttribute("src","javascript:false;");qq.remove(a)}},_upload:function(g,e){var b=this._inputs[g];if(!b){throw new Error("file with passed id was not added, or already uploaded or cancelled")}var f=this.getName(g);var c=this._createIframe(g);var d=this._createForm(c,e);d.appendChild(b);var a=this;this._attachLoadEvent(c,function(){a.log("iframe loaded");var h=a._getIframeContentJSON(c);a._options.onComplete(g,f,h);a._dequeue(g);delete a._inputs[g];setTimeout(function(){qq.remove(c)},1)});d.submit();qq.remove(d);return g},_attachLoadEvent:function(a,b){qq.attach(a,"load",function(){if(!a.parentNode){return}if(a.contentDocument&&a.contentDocument.body&&a.contentDocument.body.innerHTML=="false"){return}b()})},_getIframeContentJSON:function(iframe){var doc=iframe.contentDocument?iframe.contentDocument:iframe.contentWindow.document,response;this.log("converting iframe's innerHTML to JSON");this.log("innerHTML = "+doc.body.innerHTML);try{response=eval("("+doc.body.innerHTML+")")}catch(err){response={}}return response},_createIframe:function(b){var a=qq.toElement('<iframe src="javascript:false;" name="'+b+'" />');a.setAttribute("id",b);a.style.display="none";document.body.appendChild(a);return a},_createForm:function(a,c){var b=qq.toElement('<form method="post" enctype="multipart/form-data"></form>');var d=qq.obj2url(c,this._options.action);b.setAttribute("action",d);b.setAttribute("target",a.name);b.style.display="none";document.body.appendChild(b);return b}});qq.UploadHandlerXhr=function(a){qq.UploadHandlerAbstract.apply(this,arguments);this._files=[];this._xhrs=[];this._loaded=[]};qq.UploadHandlerXhr.isSupported=function(){var a=document.createElement("input");a.type="file";return("multiple" in a&&typeof File!="undefined"&&typeof(new XMLHttpRequest()).upload!="undefined")};qq.extend(qq.UploadHandlerXhr.prototype,qq.UploadHandlerAbstract.prototype);qq.extend(qq.UploadHandlerXhr.prototype,{add:function(a){if(!(a instanceof File)){throw new Error("Passed obj in not a File (in qq.UploadHandlerXhr)")}return this._files.push(a)-1},getName:function(b){var a=this._files[b];return a.fileName!=null?a.fileName:a.name},getSize:function(b){var a=this._files[b];return a.fileSize!=null?a.fileSize:a.size},getLoaded:function(a){return this._loaded[a]||0},_upload:function(h,f){var d=this._files[h],b=this.getName(h),c=this.getSize(h);this._loaded[h]=0;var e=this._xhrs[h]=new XMLHttpRequest();var a=this;e.upload.onprogress=function(i){if(i.lengthComputable){a._loaded[h]=i.loaded;a._options.onProgress(h,b,i.loaded,i.total)}};e.onreadystatechange=function(){if(e.readyState==4){a._onComplete(h,e)}};f=f||{};f.qqfile=b;var g=qq.obj2url(f,this._options.action);e.open("POST",g,true);e.setRequestHeader("X-Requested-With","XMLHttpRequest");e.setRequestHeader("X-File-Name",encodeURIComponent(b));e.setRequestHeader("Content-Type","application/octet-stream");e.send(d)},_onComplete:function(id,xhr){if(!this._files[id]){return}var name=this.getName(id);var size=this.getSize(id);this._options.onProgress(id,name,size,size);if(xhr.status==200){this.log("xhr - server response received");this.log("responseText = "+xhr.responseText);var response;try{response=eval("("+xhr.responseText+")")}catch(err){response={}}this._options.onComplete(id,name,response)}else{this._options.onComplete(id,name,{})}this._files[id]=null;this._xhrs[id]=null;this._dequeue(id)},_cancel:function(a){this._options.onCancel(a,this.getName(a));this._files[a]=null;if(this._xhrs[a]){this._xhrs[a].abort();this._xhrs[a]=null}}});(function(e){var g="";var c={};this.getUsername=function(){return g};this.hasPermission=function(h){return h in c};this.showLoginDialog=function(){e("#login-dialog-error").html("&nbsp;");e("#login-dialog-username").val("");e("#login-dialog-password").val("");e("#login-dialog").dialog("open")};this.isLoginCloseAllowed=function(){return g!=""};this.getPermissions=function(){sendMessageBlock({name:"whatami",headers:{}},d)};var d=function(k){if(k.data.name=="ok"){var j=0;c={};do{var h=k.data.headers["permission"+j];if(typeof h==="undefined"){break}c[h]=true;j++}while(true);e("#submissions-make-submission").toggle(hasPermission("submit"))}else{defaultReplyHandler(k)}};var a=function(i){if(i.data.name=="ok"){g=i.data.headers.user;e("#login-dialog").dialog("close");e("#tabs").show();e("#logout").show();e("#user-status").show();e("#username").html(escapeHTML(getUsername()));e("#username").show();e("#contest-status").show();registerStartStop();getPermissions();getProblems();getLanguages();getContestStatus();getClarifications();getClarificationRequests();getSubmissions();getStandings()}else{var h=i.data.headers.msg;if(h==""){h="&nbsp;"}else{h=escapeHTML(h)}e("#login-dialog-error").html(h)}};var f=function(h){if(h.data.name=="ok"){window.location.reload()}else{window.jAlert("Failed to logout: "+h.data.headers.msg)}};var b=function(){var h={name:"auth",headers:{}};if(config.autoUser&&config.autoPass){h.headers.user=config.autoUser;h.headers.pass=config.autoPass}if(!config.autoUser||config.autoUser!="nologin"){sendMessageBlock(h,a)}};this.connectionReset=function(){resetMessageQueue();if(g!=""){g="";window.jAlert("The connection with the Abacus server has been reset. This page will reload once you close this popup.","Connection reset",function(){f({data:{name:"ok"}})})}else{b()}};e(document).ready(function(){e("#username").hide();e("#user-status").hide();e("#login-dialog-submit").click(function(i){var k=e("#login-dialog-username")[0].value;var h=e("#login-dialog-password")[0].value;var j={name:"auth",headers:{user:k,pass:h}};sendMessageBlock(j,a)});e("#logout").click(function(h){var i={name:"logout",headers:{}};sendMessageBlock(i,f)})})})(jQuery);(function(b){var a=function(c){b.ajax("../resources/",{dataType:"html"}).success(function(f,g,e){if(f===undefined&&c){f=e.responseText}if(f!==undefined){var d=b("<div>").append(b.parseHTML(f)).find("#body");b("#tab-resources").html(d);showTab("tab-resources")}}).complete(function(e,f,d){setTimeout(a,15000)})};b(document).ready(function(){a(true)})})(jQuery);(function(f){var b=new Array();var g=new Array();this.getProblem=function(j){for(var h=0;h<b.length;h++){if(b[h].id==j){return b[h]}}return{}};this.getProblemForCode=function(j){for(var h=0;h<b.length;h++){if(b[h].code==j){return b[h]}}return{}};this.getProblems=function(){sendMessageBlock({name:"getproblems",headers:{}},e)};this.getCachedProblems=function(){return b};var e=function(k){if(k.data.name!="ok"){window.jAlert("Error fetching problem info: "+k.data.headers.msg);return}var h=0;b=new Array();do{var j={};j.id=k.data.headers["id"+h];if(typeof j.id==="undefined"){break}j.name=k.data.headers["name"+h];j.code=k.data.headers["code"+h];b.push(j);h++}while(true);c()};var c=function(){var h='<option value="-1">Select a problem...</option>';var k="";for(var j=0;j<b.length;j++){var l=b[j];k+='<option value="'+escapeHTML(l.id)+'">'+escapeHTML(l.code)+" - "+escapeHTML(l.name)+"</option>"}f("#clarification-request-dialog-problems").html(h+'<option value="0">General</option>'+k);f("#submission-dialog-problems").html(h+k);updateSubmissionsFilter()};this.getLanguages=function(){sendMessageBlock({name:"getlanguages",headers:{}},a)};function a(j){if(j.data.name!="ok"){window.jAlert("Error fetching language info: "+j.data.headers.msg);return}var h=0;g=new Array();do{var k=j.data.headers["language"+h];if(typeof k==="undefined"){break}g.push(k);h++}while(true);d()}function d(){var h='<option value="-1">Select a language...</option>';var k="";for(var j=0;j<g.length;j++){var l=g[j];k+='<option value="'+escapeHTML(l)+'">'+escapeHTML(l)+"</option>"}f("#submission-dialog-languages").html(h+k)}})(jQuery);(function(g){var w=[];var t=null;var m=0;var i=1;var k=2;var v=3;var j=4;var u=5;var r=6;var n=7;var c=0;var h=1;var o=2;var b=3;var d=4;var s=5;this.getStandings=function(){sendMessageBlock({name:"standings",headers:{}},function(x){e(x,true)})};this.updateStandings=function(x){e(x,false)};var l=function(z,y){var x=z.length;if(y.length!=x){return false}return z[m]==y[m]&&z[u]==y[u]&&z[r]==y[r]};var f=function(y,x){if(y[u]!=x[u]){return x[u]-y[u]}else{if(y[r]!=x[r]){return y[r]-x[r]}else{username1=y[i];username2=x[i];if(username1==username2){return 0}else{if(username1<username2){return -1}else{return 1}}}}};var a=function(y,x){for(var z=0;z<y.length;z++){if(y[z][m]==x[m]){y[z]=x;return}}y.push(x)};var p=function(B,A){var S=w;if(B!==null){if(A){w=B}else{w=new Array();for(var M=0;M<S.length;M++){w.push(S[M])}for(var y=0;y<B.length;y++){a(w,B[y])}}w.sort(f)}var D=g("#standings-searchbox");try{if(D[0].value==""){t=null}else{t=new RegExp(D[0].value,"i")}D.removeClass("invalid")}catch(O){D.addClass("invalid")}var E="";var x={};var M=0;var I=[];var F;var Q;var K=1;var z;var G=1;for(z=0;z<w.length;z++){var P=(G&1)?"odd":"even";if(S!==w){while(M<S.length&&typeof(x[S[M][m]])!="undefined"){M=M+1}if(!A&&(M>=S.length||!l(S[M],w[z]))){P+=" do-highlight"}}var H=w[z].length;if(F!=w[z][u]||Q!=w[z][r]){K=z+1}F=w[z][u];Q=w[z][r];if(t!==null&&w[z][i].match(t)){P+=" search"}E+='<tr class="'+P+'">';var J=[];var R=[];J[c]=K;R[c]="column-place";J[h]=escapeHTML(w[z][i]);R[h]="column-username";J[o]=escapeHTML(w[z][k]);R[o]="column-friendlyname";J[d]=escapeHTML(timeToString(w[z][r]));R[d]="column-total-time";J[b]=escapeHTML(w[z][u]);R[b]="column-total-solved";for(var L=n;L<w[z].length;L++){R.push("column-solved");if(w[z][L]>1){J.push('<span class="correct">+'+(w[z][L]-1)+"</span>")}else{if(w[z][L]==1){J.push('<span class="correct">+</span>')}else{if(w[z][L]<0){J.push('<span class="incorrect">&minus;'+(-w[z][L])+"</span>")}else{J.push("")}}}}for(var N=0;N<J.length;N++){E+='<td class="'+R[N]+'">'+J[N]+"</td>"}E+="</tr>";G++;x[w[z][m]]=1}g("#standings-tbody").html(E);if(S!==w){g(".do-highlight").effect("highlight",{color:"#33ff33"},3000)}};var q=function(C,y,A){var B=new Array();var z="row_"+y+"_";for(var x=0;x<A;x++){B.push(C.data.headers[z+x])}return B};this.standingsUpdate=function(B,A,z){var y="";for(var x=0;x<B.length-n;x++){y+="<col />"}g("colgroup.problem").html(y);y="<tr><th>Place</th><th>Team</th><th>Name</th><th>Points</th><th>Time</th>";for(var x=n;x<B.length;x++){y+="<th>"+escapeHTML(B[x])+"</th>"}y+="</tr>";g("#standings-thead").html(y);p(A,z);g("#standings-updatedat").text("Updated at "+new Date())};var e=function(D,y){var z=new Array();var A=D.data.headers.nrows;var B=D.data.headers.ncols;var C=q(D,0,B);for(var x=1;x<A;x++){z.push(q(D,x,B))}standingsUpdate(C,z,y)};g(document).ready(function(){g("#standings-searchbox").keypress(function(x){setTimeout(function(){p(null,false)},0)});g("#standings-searchbox").keyup(function(y){if(y.which==8){setTimeout(function(){p(null,false)},0)}if(y.which==13){var x=g("#standings-searchbox");debugHook(x[0].value)}})})})(jQuery);(function(e){var f=new Array();var i;var j={};var m={};var a=false;function h(){i=new qq.FileUploader({element:document.getElementById("submission-dialog-file-selector"),action:"submissionUpload",debug:true,onComplete:l,sizeLimit:1048576,multiple:false})}function l(v,u,t){e("#submission-dialog-submit").button({disabled:false});e("#submission-dialog-file-key").val(t.key);e(".qq-upload-button").hide()}var o=function(t){if(t=="PENDING"){return RunResult.PENDING}else{return parseInt(t)}};var s=function(t){if(!a){return true}return(!(t.prob_id in j)||j[t.prob_id])&&m[t.result]};this.updateSubmissionsFilter=function(){var u=getCachedProblems();var y=Math.max(u.length,RunResult.OTHER-RunResult.PENDING+1);var w="";for(var v=0;v<y;v++){w+="<tr><td>";if(v<u.length){var x=u[v];if(!(x.id in j)){j[x.id]=true}var z="filter-problem-"+x.id;w+='<input type="checkbox" id="'+z+'"';if(j[x.id]){w+=' checked="checked"'}if(!a){w+=' disabled="disabled"'}w+='><label for="'+z+'">'+escapeHTML(u[v].code)+" &mdash; "+escapeHTML(u[v].name)+"</label>"}else{w+="&nbsp;"}w+="</td><td>";var t=v+RunResult.PENDING;if(t<=RunResult.OTHER){var z="filter-result-"+t;w+='<input type="checkbox" id="'+z+'"';if(m[t]){w+=' checked="checked"'}if(!a){w+=' disabled="disabled"'}w+='><label for="'+z+'">'+escapeHTML(runResultString(t))+"</label>"}else{w+="&nbsp;"}w+="</td></tr>"}e("#submissions-filter-table-body").html(w)};this.getSubmissions=function(){sendMessageBlock({name:"getsubmissions",headers:{}},g)};var g=function(v){if(v.data.name!="ok"){window.jAlert("Error updating submissions: "+v.data.headers.msg);return}var t=new Array();var u=0;do{var w={};w.time=v.data.headers["time"+u];if(typeof w.time==="undefined"){break}w.submission_id=v.data.headers["submission_id"+u];w.contesttime=v.data.headers["contesttime"+u];w.prob_id=v.data.headers["prob_id"+u];w.problem=v.data.headers["problem"+u];w.comment=v.data.headers["comment"+u];w.result=o(v.data.headers["result"+u]);t.push(w);u++}while(true);f=t;q()};this.updateSubmissions=function(x){var z=x.data.headers.submission_id;var t;var w=false;for(var u=0;u<f.length;u++){var v=f[u];if(v.submission_id==z){w=true;t=u;break}}var y={};y.submission_id=z;y.time=x.data.headers.time;y.contesttime=x.data.headers.contesttime;y.prob_id=x.data.headers.prob_id;y.problem=x.data.headers.problem;y.comment=x.data.headers.comment;y.result=o(x.data.headers.result);if(w){f[t]=y}else{f.push(y)}q();return s(y)};var n=function(v){for(var t=0;t<f.length;t++){var u=f[t];if(u.submission_id==v){return u}}return false};function q(){f.sort(function(B,A){var C=A.time-B.time;if(C==0){C=A.submission_id-B.submission_id}return C});var x="";for(var w=0;w<f.length;w++){var z=f[w];if(!s(z)){continue}var y="";var v="submission-row";var u=false;var t="";switch(z.result){case RunResult.COMPILE_FAILED:y="submission-compilation-failed";u=true;break;case RunResult.ABNORMAL:case RunResult.WRONG:case RunResult.TIME_EXCEEDED:case RunResult.FORMAT_ERROR:y="submission-wrong";u=true;break;case RunResult.CORRECT:y="submission-correct";break;default:y="";break}if(u){t=" (click for details)"}x+='<tr class="'+v+'"><td>'+escapeHTML(z.submission_id)+"</td><td>"+escapeHTML(timeToString(z.contesttime))+"</td><td>"+escapeHTML(epochTimeToString(z.time))+"</td><td>"+escapeHTML(z.problem)+'</td><td><div class="'+y+'">'+escapeHTML(z.comment)+t+"</div></td></tr>"}e("#submissions-tbody").html(x);e("tr.submission-row").hover(function(){e(this).addClass("pointer-hover row-hover")},function(){e(this).removeClass("pointer-hover row-hover")}).click(function(){var A=e(e(this).children()[0]).text();showSubmission(n(A))});e(".abacus-button:not(.ui-state-disabled)").hover(function(){e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")}).mousedown(function(){e(this).addClass("ui-state-active")}).mouseup(function(){e(this).removeClass("ui-state-active")})}function p(w,x){var t=getCachedProblems();for(var u=0;u<t.length;u++){var v=t[u];var y="#filter-problem-"+v.id;j[v.id]=e(y).prop("checked")}for(var u=RunResult.PENDING;u<=RunResult.OTHER;u++){var y="#filter-result-"+u;m[u]=e(y).prop("checked")}q()}function b(t){i.setParams({user:getUsername()});e("#submission-dialog-submit").button({disabled:true});e("#submission-dialog").dialog("open");e(".qq-upload-button").show()}function c(t){if(t.data.name=="ok"){k();e("#submission-dialog").dialog("close")}else{window.jAlert("Failed to make submission. Error was: "+t.data.headers.msg)}}this.submissionDialogClose=function(t,u){h()};function d(){if(window.ActiveXObject){var t=["Msxml2.XMLHTTP","Microsoft.XMLHTTP"];for(var u=0;u<t.length;u++){try{return new ActiveXObject(t[u])}catch(v){}}}else{if(window.XMLHttpRequest){return new XMLHttpRequest()}else{return false}}}function k(){var t=r();if(!t){return}var u=d();if(u){u.open("POST","submissionUpload",true);u.setRequestHeader("X-Requested-With","XMLHttpRequest");u.setRequestHeader("Content-type","application/x-www-form-urlencoded");u.send("remove&user="+getUsername()+"&key="+t)}else{}}function r(){var t=e("#submission-dialog-file-key").val();if(t!=""){return t}else{return false}}e(document).ready(function(){h();e("#submissions-filter-accordion").accordion({collapsible:true,active:false,heightStyle:"content",header:"h3"});e("#submissions-filter-table").on("change","input",null,p);for(var t=RunResult.PENDING;t<=RunResult.OTHER;t++){m[t]=false}m[RunResult.JUDGE]=true;m[RunResult.OTHER]=true;e("#submissions-filter-enable").change(function(u,v){a=e(this).prop("checked");e("#submissions-filter-table :input").prop("disabled",!a);updateSubmissionsFilter();p()}).change();e("#submissions-make-submission").click(function(u){getProblems();getLanguages();queueHandler({},b)});e("#submission-dialog-cancel").click(function(u){k();e("#submission-dialog").dialog("close")});e("#submission-dialog-submit").click(function(u){var v=e("#submission-dialog-problems").val();if(v==-1){window.jAlert("You must select a problem!");return}var w=e("#submission-dialog-languages").val();if(w==-1){window.jAlert("You must select a language!");return}sendMessageBlock({name:"submit",headers:{prob_id:v,lang:w,},file_key:r(),},c)})})})(jQuery);(function(e){var b=new Array();this.showSubmission=function(j){var i=j.submission_id;finishFetch=function(){if(hasPermission("see_problem_details")){sendMessageBlock({name:"getprobfile",headers:{prob_id:j.prob_id,file:"testcase.output"}},function(k){f(k,"Expected output",true)})}sendMessageBlock({name:"getsubmissionsource",headers:{submission_id:i}},function(k){f(k,"Contestant source")});queueHandler(j,a)};if(hasPermission("see_submission_details")||j.result==RunResult.COMPILE_FAILED){sendMessageBlock({name:"fetchfile",headers:{request:"count",submission_id:i,}},function(m){if(m.data.name=="ok"){b=new Array();var l=m.data.headers.count;for(var k=0;k<l;k++){sendMessageBlock({name:"fetchfile",headers:{request:"data",submission_id:i,index:""+k}},f)}finishFetch()}else{defaultReplyHandler(m)}})}else{b=new Array();var h=null;switch(j.result){case RunResult.WRONG:h="When given our test data, your solution produced the wrong answers.\nKeep in mind that we test your solution with test data that is\nDIFFERENT TO (and usually harder than) the sample data shown in the\nquestion.\n\nPlease do not ask for more details of what you got wrong. That is up\nto you to discover.\n";break;case RunResult.TIME_EXCEEDED:h="When given our test data, your solution ran for longer than the\nallowed time (which should appear on the question paper).\nKeep in mind that we test your solution with test data that is\nDIFFERENT TO (and usually harder than) the sample data shown in the\nquestion.\n\nPlease do not ask how close your program was to running in time. It\nis killed as soon as it runs over time, so we do not know.\n";break;case RunResult.FORMAT_ERROR:h="The output from your solution did not match the format specified\nin the problem statement. Please check that\n- you do not have any debugging print statements\n- you have no written any prompts for input\n- you have used uppercase and lowercase correctly, if applicable\nHint: when running on the sample input, the output should EXACTLY\nmatch the sample output, with nothing added.\n\nPlease do not ask what is wrong with your formatting. It is up\nto you to figure this out, and you will not be told.\n";break;case RunResult.ABNORMAL:h="When given our test data, your solution did not terminate cleanly.\nThere are many reasons this can happen, including\n- throwing an uncaught exception\n- exceeding the resource limits (such as memory)\n- invalid Python syntax\n- returning an exit code other than 0 from C/C++\n- invalid memory use in C/C++\n- invalid mathematical operations (e.g., divide by zero)\nFor more details, refer to the manual (left-hand tab).\nKeep in mind that we test your solution with test data that is\nDIFFERENT TO (and usually harder than) the sample data shown in the\nquestion.\n\nPlease do not ask for more details of your error. You will not be told.\n";break}if(h!==null){b.push({name:"Explanation",content:h})}finishFetch()}};var f=function(k,i,h){if(k.data.name=="ok"){var j=parseUtf8(k.data.content);if(typeof i==="undefined"){i=k.data.headers.name}b.push({name:i,content:j})}else{if(h&&k.data.name=="err"){}else{defaultReplyHandler(k)}}};var a=function(m){var n=m.data.data;var l=n.submission_id;var h=(hasPermission("judge")&&n.result==RunResult.JUDGE)||hasPermission("judge_override");html="";for(var k=0;k<b.length;k++){var j=b[k].name;html+='<option value="'+k+'">'+escapeHTML(j)+"</option>"}e("#submission-result-dialog-file").html(html).val(0).on("change keypress keyup",d).change();if(h){e("#submission-result-dialog").dialog({buttons:[{text:"Defer",click:function(){e(this).dialog("close")}},{text:"Correct",click:function(){g(l,RunResult.CORRECT)}},{text:"Wrong",click:function(){g(l,RunResult.WRONG)}},{text:"Format error",click:function(){g(l,RunResult.FORMAT_ERROR)}}]})}else{e("#submission-result-dialog").dialog({buttons:[{text:"Ok",click:function(){e(this).dialog("close")}},{text:"Request clarification",click:function(){requestClarificationDialog(n.prob_id,"[Submission "+l+"] ")}}]})}e("#submission-result-dialog").dialog("open")};var d=function(){var h=e(this).val();if(h>=0&&h<b.length){e("#submission-result-dialog-contents").val(b[h].content)}};var g=function(i,h){sendMessageBlock({name:"mark",headers:{submission_id:i,result:""+h,comment:runResultString(h)}},c)};var c=function(h){if(h.data.name=="ok"){e("#submission-result-dialog").dialog("close")}else{defaultReplyHandler(h)}};e(document).ready(function(){e("#submission-result-dialog-contents")[0].wrap="off";e("#submission-result-dialog-wrap").change(function(i,j){var h=e("#submission-result-dialog-contents");if(e(this).prop("checked")){h.removeClass("nowrap");h[0].wrap="on"}else{h.addClass("nowrap");h[0].wrap="off"}})})})(jQuery);